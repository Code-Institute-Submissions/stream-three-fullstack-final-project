{% extends 'base.html' %}
{% block content %}
<h1>Cycle Porthole</h1>
<p>You are logged in as {{ context.username }}</p>
<p>Fileo Cycle ID: {{ context.cycle_id }}</p>
<p>Client: {{ context.client.username }}</p>
<h2>Job Title</h2>
<h4>Job Number: {{ context.cycle.job.job_number }}</h4>
<h3>{{ context.cycle.job.job_title }}</h3>
<p> Start Date: {{ context.cycle.job.start_date }}</p>
<p> End Date: {{ context.cycle.job.end_date }}</p>
<p>@{{ context.cycle.job.location }}</p>
<h3>Cycle Description</h3>
<P>{{ context.cycle.description }}</P>
<h3>Cycle Value</h3>
{% if context.quote.cycle_value %}
<p>{{ context.quote.cycle_value }}</p>
{% else %}
<p>Cycle Value not entered yet.</p>
{% endif %}
<hr>
<div>
    <h3>Upload Your Quote</h3>
    <img alt='Show image of PDF icon if uploaded'>
    <form method="POST" enctype="multipart/form-data" action="{% url 'quote_upload' username=context.username cycle_id=context.cycle.id client_username=context.cycle.client %}">
        {% csrf_token %}
        {{ context.quote_form.as_p }}
        <button type="submit">Submit</button>
    </form>
    <ul>
        <li><a href="{{ context.quote.file.url }}" download="">Download File</a></li>
        <li><a href="{{ context.quote.file.url }}" target="_blank">View in Browser</a></li> 
    </ul>
    <div>
        <h4>Approval</h4>
        <div>
            {% for message in messages %}
                {% if 'quote_message' in message.tags %}
                    {{message}}
                {% endif %}
            {% endfor %}
            <form action="{% url 'quote_status' username=context.username cycle_id=context.cycle.id client_username=context.cycle.client %}" method="POST">
                {% csrf_token %}
                <fieldset>
                    {{ context.status_form.as_p }}
                    <button type="submit">Submit</button>
                </fieldset>
            </form> 
        </div>
    </div>
</div>
<hr>
<div>
    <h3>Upload Your PO</h3>
    <img alt='Show image of PDF icon if uploaded'>
    <form method="POST" enctype="multipart/form-data" action="{% url 'po_upload' username=context.username cycle_id=context.cycle.id client_username=context.cycle.client %}">
        {% csrf_token %}
        {{ context.po_form.as_p }}
        <button type="submit">Submit</button>
    </form>
    <ul>
        <li><a href="{{ context.po.file.url }}" download>Download File</a></li>
        <li><a href="{{ context.po.file.url }}" target="_blank">View in Browser</a></li> 
    </ul>
    <div>
        <h4>PO Status</h4>
        <div>
            {% for message in messages %}
                {% if 'po_message' in message.tags %}
                    {{message}}
                {% endif %}
            {% endfor %}
            <form action="{% url 'po_status' username=context.username cycle_id=context.cycle.id client_username=context.cycle.client %}" method="POST">
                <fieldset>
                    {% csrf_token %}
                    {{ context.status_form.as_p }}
                    <button type="submit">Set Status</button>
                </fieldset>
            </form>
        </div>
    </div>
</div>
<hr>
<div>
    <h3>Upload Your Invoice</h3>
    <img alt='Show image of PDF icon if uploaded'>
    <form method="POST" enctype="multipart/form-data" action="{% url 'invoice_upload' username=context.username cycle_id=context.cycle.id client_username=context.cycle.client %}">
        {% csrf_token %}
        {{ context.invoice_form.as_p }}
        <button type="submit">Submit</button>
    </form>
    <ul>
        <li><a href="{{ context.invoice.file.url }}" download>Download File</a></li>
        <li><a href="{{ context.invoice.file.url }}" target="_blank">View in Browser</a></li> 
    </ul>
    <div>
        <h4>Invoice Status</h4>
        <div>
            {% for message in messages %}
                {% if 'invoice_message' in message.tags %}
                        {{message}}
                {% endif %}
            {% endfor %}
            <form action="{% url 'invoice_status' username=context.username cycle_id=context.cycle.id client_username=context.cycle.client %}" method="POST">
                <fieldset>
                    {% csrf_token %}
                    {{ context.status_form.as_p }}
                    <button type="submit">Set Status</button>
                </fieldset>
            </form>
        </div>
    </div>
</div>
<hr>
{% endblock %}